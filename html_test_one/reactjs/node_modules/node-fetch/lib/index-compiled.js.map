{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n// Based on https://github.com/tmpvar/jsdom/blob/aa85b2abf07766ff7bf5c1f6daafb3726f2f2db5/lib/jsdom/living/blob.js\n// (MIT licensed)\n\nconst BUFFER = Symbol('buffer');\nconst TYPE = Symbol('type');\nconst CLOSED = Symbol('closed');\n\nclass Blob {\n\tconstructor() {\n\t\tObject.defineProperty(this, Symbol.toStringTag, {\n\t\t\tvalue: 'Blob',\n\t\t\twritable: false,\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true\n\t\t});\n\n\t\tthis[CLOSED] = false;\n\t\tthis[TYPE] = '';\n\n\t\tconst blobParts = arguments[0];\n\t\tconst options = arguments[1];\n\n\t\tconst buffers = [];\n\n\t\tif (blobParts) {\n\t\t\tconst a = blobParts;\n\t\t\tconst length = Number(a.length);\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tconst element = a[i];\n\t\t\t\tlet buffer;\n\t\t\t\tif (element instanceof Buffer) {\n\t\t\t\t\tbuffer = element;\n\t\t\t\t} else if (ArrayBuffer.isView(element)) {\n\t\t\t\t\tbuffer = Buffer.from(element.buffer, element.byteOffset, element.byteLength);\n\t\t\t\t} else if (element instanceof ArrayBuffer) {\n\t\t\t\t\tbuffer = Buffer.from(element);\n\t\t\t\t} else if (element instanceof Blob) {\n\t\t\t\t\tbuffer = element[BUFFER];\n\t\t\t\t} else {\n\t\t\t\t\tbuffer = Buffer.from(typeof element === 'string' ? element : String(element));\n\t\t\t\t}\n\t\t\t\tbuffers.push(buffer);\n\t\t\t}\n\t\t}\n\n\t\tthis[BUFFER] = Buffer.concat(buffers);\n\n\t\tlet type = options && options.type !== undefined && String(options.type).toLowerCase();\n\t\tif (type && !/[^\\u0020-\\u007E]/.test(type)) {\n\t\t\tthis[TYPE] = type;\n\t\t}\n\t}\n\tget size() {\n\t\treturn this[CLOSED] ? 0 : this[BUFFER].length;\n\t}\n\tget type() {\n\t\treturn this[TYPE];\n\t}\n\tget isClosed() {\n\t\treturn this[CLOSED];\n\t}\n\tslice() {\n\t\tconst size = this.size;\n\n\t\tconst start = arguments[0];\n\t\tconst end = arguments[1];\n\t\tlet relativeStart, relativeEnd;\n\t\tif (start === undefined) {\n\t\t\trelativeStart = 0;\n\t\t} else if (start < 0) {\n\t\t\trelativeStart = Math.max(size + start, 0);\n\t\t} else {\n\t\t\trelativeStart = Math.min(start, size);\n\t\t}\n\t\tif (end === undefined) {\n\t\t\trelativeEnd = size;\n\t\t} else if (end < 0) {\n\t\t\trelativeEnd = Math.max(size + end, 0);\n\t\t} else {\n\t\t\trelativeEnd = Math.min(end, size);\n\t\t}\n\t\tconst span = Math.max(relativeEnd - relativeStart, 0);\n\n\t\tconst buffer = this[BUFFER];\n\t\tconst slicedBuffer = buffer.slice(relativeStart, relativeStart + span);\n\t\tconst blob = new Blob([], { type: arguments[2] });\n\t\tblob[BUFFER] = slicedBuffer;\n\t\tblob[CLOSED] = this[CLOSED];\n\t\treturn blob;\n\t}\n\tclose() {\n\t\tthis[CLOSED] = true;\n\t}\n}\n\nObject.defineProperty(Blob.prototype, Symbol.toStringTag, {\n\tvalue: 'BlobPrototype',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * fetch-error.js\n *\n * FetchError interface for operational errors\n */\n\n/**\n * Create FetchError instance\n *\n * @param   String      message      Error message for human\n * @param   String      type         Error type for machine\n * @param   String      systemError  For Node.js system error\n * @return  FetchError\n */\nfunction FetchError(message, type, systemError) {\n  Error.call(this, message);\n\n  this.message = message;\n  this.type = type;\n\n  // when err.type is `system`, err.code contains system error code\n  if (systemError) {\n    this.code = this.errno = systemError.code;\n  }\n\n  // hide custom error implementation details from end-users\n  Error.captureStackTrace(this, this.constructor);\n}\n\nFetchError.prototype = Object.create(Error.prototype);\nFetchError.prototype.constructor = FetchError;\nFetchError.prototype.name = 'FetchError';\n\n/**\n * body.js\n *\n * Body interface provides common methods for Request and Response\n */\n\nconst Stream = require('stream');\n\nvar _require$1 = require('stream');\n\nconst PassThrough$1 = _require$1.PassThrough;\n\n\nconst DISTURBED = Symbol('disturbed');\n\nlet convert;\ntry {\n\tconvert = require('encoding').convert;\n} catch (e) {}\n\n/**\n * Body class\n *\n * Cannot use ES6 class because Body must be called with .call().\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nfunction Body(body) {\n\tvar _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n\t    _ref$size = _ref.size;\n\n\tlet size = _ref$size === undefined ? 0 : _ref$size;\n\tvar _ref$timeout = _ref.timeout;\n\tlet timeout = _ref$timeout === undefined ? 0 : _ref$timeout;\n\n\tif (body == null) {\n\t\t// body is undefined or null\n\t\tbody = null;\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t} else if (body instanceof Blob) {\n\t\t// body is blob\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t} else if (body instanceof Stream) {\n\t\t// body is stream\n\t} else {\n\t\t// none of the above\n\t\t// coerce to string\n\t\tbody = String(body);\n\t}\n\tthis.body = body;\n\tthis[DISTURBED] = false;\n\tthis.size = size;\n\tthis.timeout = timeout;\n}\n\nBody.prototype = {\n\tget bodyUsed() {\n\t\treturn this[DISTURBED];\n\t},\n\n\t/**\n  * Decode response as ArrayBuffer\n  *\n  * @return  Promise\n  */\n\tarrayBuffer() {\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n\t\t});\n\t},\n\n\t/**\n  * Return raw response as Blob\n  *\n  * @return Promise\n  */\n\tblob() {\n\t\tlet ct = this.headers && this.headers.get('content-type') || '';\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn Object.assign(\n\t\t\t// Prevent copying\n\t\t\tnew Blob([], {\n\t\t\t\ttype: ct.toLowerCase()\n\t\t\t}), {\n\t\t\t\t[BUFFER]: buf\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n  * Decode response as json\n  *\n  * @return  Promise\n  */\n\tjson() {\n\t\tvar _this = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(buffer.toString());\n\t\t\t} catch (err) {\n\t\t\t\treturn Body.Promise.reject(new FetchError(`invalid json response body at ${_this.url} reason: ${err.message}`, 'invalid-json'));\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n  * Decode response as text\n  *\n  * @return  Promise\n  */\n\ttext() {\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn buffer.toString();\n\t\t});\n\t},\n\n\t/**\n  * Decode response as buffer (non-spec api)\n  *\n  * @return  Promise\n  */\n\tbuffer() {\n\t\treturn consumeBody.call(this);\n\t},\n\n\t/**\n  * Decode response as text, while automatically detecting the encoding and\n  * trying to decode to UTF-8 (non-spec api)\n  *\n  * @return  Promise\n  */\n\ttextConverted() {\n\t\tvar _this2 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn convertBody(buffer, _this2.headers);\n\t\t});\n\t}\n\n};\n\nBody.mixIn = function (proto) {\n\tfor (const name of Object.getOwnPropertyNames(Body.prototype)) {\n\t\t// istanbul ignore else: future proof\n\t\tif (!(name in proto)) {\n\t\t\tconst desc = Object.getOwnPropertyDescriptor(Body.prototype, name);\n\t\t\tObject.defineProperty(proto, name, desc);\n\t\t}\n\t}\n};\n\n/**\n * Decode buffers into utf-8 string\n *\n * @return  Promise\n */\nfunction consumeBody(body) {\n\tvar _this3 = this;\n\n\tif (this[DISTURBED]) {\n\t\treturn Body.Promise.reject(new Error(`body used already for: ${this.url}`));\n\t}\n\n\tthis[DISTURBED] = true;\n\n\t// body is null\n\tif (this.body === null) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is string\n\tif (typeof this.body === 'string') {\n\t\treturn Body.Promise.resolve(Buffer.from(this.body));\n\t}\n\n\t// body is blob\n\tif (this.body instanceof Blob) {\n\t\treturn Body.Promise.resolve(this.body[BUFFER]);\n\t}\n\n\t// body is buffer\n\tif (Buffer.isBuffer(this.body)) {\n\t\treturn Body.Promise.resolve(this.body);\n\t}\n\n\t// istanbul ignore if: should never happen\n\tif (!(this.body instanceof Stream)) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is stream\n\t// get ready to actually consume the body\n\tlet accum = [];\n\tlet accumBytes = 0;\n\tlet abort = false;\n\n\treturn new Body.Promise(function (resolve, reject) {\n\t\tlet resTimeout;\n\n\t\t// allow timeout on slow response body\n\t\tif (_this3.timeout) {\n\t\t\tresTimeout = setTimeout(function () {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`Response timeout while trying to fetch ${_this3.url} (over ${_this3.timeout}ms)`, 'body-timeout'));\n\t\t\t}, _this3.timeout);\n\t\t}\n\n\t\t// handle stream error, such as incorrect content-encoding\n\t\t_this3.body.on('error', function (err) {\n\t\t\treject(new FetchError(`Invalid response body while trying to fetch ${_this3.url}: ${err.message}`, 'system', err));\n\t\t});\n\n\t\t_this3.body.on('data', function (chunk) {\n\t\t\tif (abort || chunk === null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (_this3.size && accumBytes + chunk.length > _this3.size) {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`content size at ${_this3.url} over limit: ${_this3.size}`, 'max-size'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\taccumBytes += chunk.length;\n\t\t\taccum.push(chunk);\n\t\t});\n\n\t\t_this3.body.on('end', function () {\n\t\t\tif (abort) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclearTimeout(resTimeout);\n\t\t\tresolve(Buffer.concat(accum));\n\t\t});\n\t});\n}\n\n/**\n * Detect buffer encoding and convert to target encoding\n * ref: http://www.w3.org/TR/2011/WD-html5-20110113/parsing.html#determining-the-character-encoding\n *\n * @param   Buffer  buffer    Incoming buffer\n * @param   String  encoding  Target encoding\n * @return  String\n */\nfunction convertBody(buffer, headers) {\n\tif (typeof convert !== 'function') {\n\t\tthrow new Error('The package `encoding` must be installed to use the textConverted() function');\n\t}\n\n\tconst ct = headers.get('content-type');\n\tlet charset = 'utf-8';\n\tlet res, str;\n\n\t// header\n\tif (ct) {\n\t\tres = /charset=([^;]*)/i.exec(ct);\n\t}\n\n\t// no charset in content type, peek at response body for at most 1024 bytes\n\tstr = buffer.slice(0, 1024).toString();\n\n\t// html5\n\tif (!res && str) {\n\t\tres = /<meta.+?charset=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// html4\n\tif (!res && str) {\n\t\tres = /<meta[\\s]+?http-equiv=(['\"])content-type\\1[\\s]+?content=(['\"])(.+?)\\2/i.exec(str);\n\n\t\tif (res) {\n\t\t\tres = /charset=(.*)/i.exec(res.pop());\n\t\t}\n\t}\n\n\t// xml\n\tif (!res && str) {\n\t\tres = /<\\?xml.+?encoding=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// found charset\n\tif (res) {\n\t\tcharset = res.pop();\n\n\t\t// prevent decode issues when sites use incorrect encoding\n\t\t// ref: https://hsivonen.fi/encoding-menu/\n\t\tif (charset === 'gb2312' || charset === 'gbk') {\n\t\t\tcharset = 'gb18030';\n\t\t}\n\t}\n\n\t// turn raw buffers into a single utf-8 buffer\n\treturn convert(buffer, 'UTF-8', charset).toString();\n}\n\n/**\n * Detect a URLSearchParams object\n * ref: https://github.com/bitinn/node-fetch/issues/296#issuecomment-307598143\n *\n * @param   Object  obj     Object to detect by type or brand\n * @return  String\n */\nfunction isURLSearchParams(obj) {\n\t// Duck-typing as a necessary condition.\n\tif (typeof obj !== 'object' || typeof obj.append !== 'function' || typeof obj.delete !== 'function' || typeof obj.get !== 'function' || typeof obj.getAll !== 'function' || typeof obj.has !== 'function' || typeof obj.set !== 'function') {\n\t\treturn false;\n\t}\n\n\t// Brand-checking and more duck-typing as optional condition.\n\treturn obj.constructor.name === 'URLSearchParams' || Object.prototype.toString.call(obj) === '[object URLSearchParams]' || typeof obj.sort === 'function';\n}\n\n/**\n * Clone body given Res/Req instance\n *\n * @param   Mixed  instance  Response or Request instance\n * @return  Mixed\n */\nfunction clone(instance) {\n\tlet p1, p2;\n\tlet body = instance.body;\n\n\t// don't allow cloning a used body\n\tif (instance.bodyUsed) {\n\t\tthrow new Error('cannot clone body after it is used');\n\t}\n\n\t// check that body is a stream and not form-data object\n\t// note: we can't clone the form-data object without having it as a dependency\n\tif (body instanceof Stream && typeof body.getBoundary !== 'function') {\n\t\t// tee instance body\n\t\tp1 = new PassThrough$1();\n\t\tp2 = new PassThrough$1();\n\t\tbody.pipe(p1);\n\t\tbody.pipe(p2);\n\t\t// set instance body to teed body and return the other teed body\n\t\tinstance.body = p1;\n\t\tbody = p2;\n\t}\n\n\treturn body;\n}\n\n/**\n * Performs the operation \"extract a `Content-Type` value from |object|\" as\n * specified in the specification:\n * https://fetch.spec.whatwg.org/#concept-bodyinit-extract\n *\n * This function assumes that instance.body is present and non-null.\n *\n * @param   Mixed  instance  Response or Request instance\n */\nfunction extractContentType(instance) {\n\tconst body = instance.body;\n\n\t// istanbul ignore if: Currently, because of a guard in Request, body\n\t// can never be null. Included here for completeness.\n\n\tif (body === null) {\n\t\t// body is null\n\t\treturn null;\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t\treturn 'text/plain;charset=UTF-8';\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t\treturn 'application/x-www-form-urlencoded;charset=UTF-8';\n\t} else if (body instanceof Blob) {\n\t\t// body is blob\n\t\treturn body.type || null;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn null;\n\t} else if (typeof body.getBoundary === 'function') {\n\t\t// detect form data input from form-data module\n\t\treturn `multipart/form-data;boundary=${body.getBoundary()}`;\n\t} else {\n\t\t// body is stream\n\t\t// can't really do much about this\n\t\treturn null;\n\t}\n}\n\nfunction getTotalBytes(instance) {\n\tconst body = instance.body;\n\n\t// istanbul ignore if: included for completion\n\n\tif (body === null) {\n\t\t// body is null\n\t\treturn 0;\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t\treturn Buffer.byteLength(body);\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is URLSearchParams\n\t\treturn Buffer.byteLength(String(body));\n\t} else if (body instanceof Blob) {\n\t\t// body is blob\n\t\treturn body.size;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn body.length;\n\t} else if (body && typeof body.getLengthSync === 'function') {\n\t\t// detect form data input from form-data module\n\t\tif (body._lengthRetrievers && body._lengthRetrievers.length == 0 || // 1.x\n\t\tbody.hasKnownLength && body.hasKnownLength()) {\n\t\t\t// 2.x\n\t\t\treturn body.getLengthSync();\n\t\t}\n\t\treturn null;\n\t} else {\n\t\t// body is stream\n\t\t// can't really do much about this\n\t\treturn null;\n\t}\n}\n\nfunction writeToStream(dest, instance) {\n\tconst body = instance.body;\n\n\n\tif (body === null) {\n\t\t// body is null\n\t\tdest.end();\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t\tdest.write(body);\n\t\tdest.end();\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is URLSearchParams\n\t\tdest.write(Buffer.from(String(body)));\n\t\tdest.end();\n\t} else if (body instanceof Blob) {\n\t\t// body is blob\n\t\tdest.write(body[BUFFER]);\n\t\tdest.end();\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\tdest.write(body);\n\t\tdest.end();\n\t} else {\n\t\t// body is stream\n\t\tbody.pipe(dest);\n\t}\n}\n\n// expose Promise\nBody.Promise = global.Promise;\n\n/**\n * A set of utilities borrowed from Node.js' _http_common.js\n */\n\n/**\n * Verifies that the given val is a valid HTTP token\n * per the rules defined in RFC 7230\n * See https://tools.ietf.org/html/rfc7230#section-3.2.6\n *\n * Allowed characters in an HTTP token:\n * ^_`a-z  94-122\n * A-Z     65-90\n * -       45\n * 0-9     48-57\n * !       33\n * #$%&'   35-39\n * *+      42-43\n * .       46\n * |       124\n * ~       126\n *\n * This implementation of checkIsHttpToken() loops over the string instead of\n * using a regular expression since the former is up to 180% faster with v8 4.9\n * depending on the string length (the shorter the string, the larger the\n * performance difference)\n *\n * Additionally, checkIsHttpToken() is currently designed to be inlinable by v8,\n * so take care when making changes to the implementation so that the source\n * code size does not exceed v8's default max_inlined_source_size setting.\n **/\n/* istanbul ignore next */\nfunction isValidTokenChar(ch) {\n  if (ch >= 94 && ch <= 122) return true;\n  if (ch >= 65 && ch <= 90) return true;\n  if (ch === 45) return true;\n  if (ch >= 48 && ch <= 57) return true;\n  if (ch === 34 || ch === 40 || ch === 41 || ch === 44) return false;\n  if (ch >= 33 && ch <= 46) return true;\n  if (ch === 124 || ch === 126) return true;\n  return false;\n}\n/* istanbul ignore next */\nfunction checkIsHttpToken(val) {\n  if (typeof val !== 'string' || val.length === 0) return false;\n  if (!isValidTokenChar(val.charCodeAt(0))) return false;\n  const len = val.length;\n  if (len > 1) {\n    if (!isValidTokenChar(val.charCodeAt(1))) return false;\n    if (len > 2) {\n      if (!isValidTokenChar(val.charCodeAt(2))) return false;\n      if (len > 3) {\n        if (!isValidTokenChar(val.charCodeAt(3))) return false;\n        for (var i = 4; i < len; i++) {\n          if (!isValidTokenChar(val.charCodeAt(i))) return false;\n        }\n      }\n    }\n  }\n  return true;\n}\n/**\n * True if val contains an invalid field-vchar\n *  field-value    = *( field-content / obs-fold )\n *  field-content  = field-vchar [ 1*( SP / HTAB ) field-vchar ]\n *  field-vchar    = VCHAR / obs-text\n *\n * checkInvalidHeaderChar() is currently designed to be inlinable by v8,\n * so take care when making changes to the implementation so that the source\n * code size does not exceed v8's default max_inlined_source_size setting.\n **/\n/* istanbul ignore next */\nfunction checkInvalidHeaderChar(val) {\n  val += '';\n  if (val.length < 1) return false;\n  var c = val.charCodeAt(0);\n  if (c <= 31 && c !== 9 || c > 255 || c === 127) return true;\n  if (val.length < 2) return false;\n  c = val.charCodeAt(1);\n  if (c <= 31 && c !== 9 || c > 255 || c === 127) return true;\n  if (val.length < 3) return false;\n  c = val.charCodeAt(2);\n  if (c <= 31 && c !== 9 || c > 255 || c === 127) return true;\n  for (var i = 3; i < val.length; ++i) {\n    c = val.charCodeAt(i);\n    if (c <= 31 && c !== 9 || c > 255 || c === 127) return true;\n  }\n  return false;\n}\n\n/**\n * headers.js\n *\n * Headers class offers convenient helpers\n */\n\nfunction sanitizeName(name) {\n\tname += '';\n\tif (!checkIsHttpToken(name)) {\n\t\tthrow new TypeError(`${name} is not a legal HTTP header name`);\n\t}\n\treturn name.toLowerCase();\n}\n\nfunction sanitizeValue(value) {\n\tvalue += '';\n\tif (checkInvalidHeaderChar(value)) {\n\t\tthrow new TypeError(`${value} is not a legal HTTP header value`);\n\t}\n\treturn value;\n}\n\nconst MAP = Symbol('map');\nclass Headers {\n\t/**\n  * Headers class\n  *\n  * @param   Object  headers  Response headers\n  * @return  Void\n  */\n\tconstructor() {\n\t\tlet init = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n\t\tthis[MAP] = Object.create(null);\n\n\t\tif (init instanceof Headers) {\n\t\t\tconst rawHeaders = init.raw();\n\t\t\tconst headerNames = Object.keys(rawHeaders);\n\n\t\t\tfor (const headerName of headerNames) {\n\t\t\t\tfor (const value of rawHeaders[headerName]) {\n\t\t\t\t\tthis.append(headerName, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// We don't worry about converting prop to ByteString here as append()\n\t\t// will handle it.\n\t\tif (init == null) {\n\t\t\t// no op\n\t\t} else if (typeof init === 'object') {\n\t\t\tconst method = init[Symbol.iterator];\n\t\t\tif (method != null) {\n\t\t\t\tif (typeof method !== 'function') {\n\t\t\t\t\tthrow new TypeError('Header pairs must be iterable');\n\t\t\t\t}\n\n\t\t\t\t// sequence<sequence<ByteString>>\n\t\t\t\t// Note: per spec we have to first exhaust the lists then process them\n\t\t\t\tconst pairs = [];\n\t\t\t\tfor (const pair of init) {\n\t\t\t\t\tif (typeof pair !== 'object' || typeof pair[Symbol.iterator] !== 'function') {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be iterable');\n\t\t\t\t\t}\n\t\t\t\t\tpairs.push(Array.from(pair));\n\t\t\t\t}\n\n\t\t\t\tfor (const pair of pairs) {\n\t\t\t\t\tif (pair.length !== 2) {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be a name/value tuple');\n\t\t\t\t\t}\n\t\t\t\t\tthis.append(pair[0], pair[1]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// record<ByteString, ByteString>\n\t\t\t\tfor (const key of Object.keys(init)) {\n\t\t\t\t\tconst value = init[key];\n\t\t\t\t\tthis.append(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new TypeError('Provided initializer must be an object');\n\t\t}\n\n\t\tObject.defineProperty(this, Symbol.toStringTag, {\n\t\t\tvalue: 'Headers',\n\t\t\twritable: false,\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true\n\t\t});\n\t}\n\n\t/**\n  * Return first header value given name\n  *\n  * @param   String  name  Header name\n  * @return  Mixed\n  */\n\tget(name) {\n\t\tconst list = this[MAP][sanitizeName(name)];\n\t\tif (!list) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn list.join(', ');\n\t}\n\n\t/**\n  * Iterate over all headers\n  *\n  * @param   Function  callback  Executed for each item with parameters (value, name, thisArg)\n  * @param   Boolean   thisArg   `this` context for callback function\n  * @return  Void\n  */\n\tforEach(callback) {\n\t\tlet thisArg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n\t\tlet pairs = getHeaderPairs(this);\n\t\tlet i = 0;\n\t\twhile (i < pairs.length) {\n\t\t\tvar _pairs$i = pairs[i];\n\t\t\tconst name = _pairs$i[0],\n\t\t\t      value = _pairs$i[1];\n\n\t\t\tcallback.call(thisArg, value, name, this);\n\t\t\tpairs = getHeaderPairs(this);\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/**\n  * Overwrite header values given name\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tset(name, value) {\n\t\tthis[MAP][sanitizeName(name)] = [sanitizeValue(value)];\n\t}\n\n\t/**\n  * Append a value onto existing header\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tappend(name, value) {\n\t\tif (!this.has(name)) {\n\t\t\tthis.set(name, value);\n\t\t\treturn;\n\t\t}\n\n\t\tthis[MAP][sanitizeName(name)].push(sanitizeValue(value));\n\t}\n\n\t/**\n  * Check for header name existence\n  *\n  * @param   String   name  Header name\n  * @return  Boolean\n  */\n\thas(name) {\n\t\treturn !!this[MAP][sanitizeName(name)];\n\t}\n\n\t/**\n  * Delete all header values given name\n  *\n  * @param   String  name  Header name\n  * @return  Void\n  */\n\tdelete(name) {\n\t\tdelete this[MAP][sanitizeName(name)];\n\t}\n\n\t/**\n  * Return raw headers (non-spec api)\n  *\n  * @return  Object\n  */\n\traw() {\n\t\treturn this[MAP];\n\t}\n\n\t/**\n  * Get an iterator on keys.\n  *\n  * @return  Iterator\n  */\n\tkeys() {\n\t\treturn createHeadersIterator(this, 'key');\n\t}\n\n\t/**\n  * Get an iterator on values.\n  *\n  * @return  Iterator\n  */\n\tvalues() {\n\t\treturn createHeadersIterator(this, 'value');\n\t}\n\n\t/**\n  * Get an iterator on entries.\n  *\n  * This is the default iterator of the Headers object.\n  *\n  * @return  Iterator\n  */\n\t[Symbol.iterator]() {\n\t\treturn createHeadersIterator(this, 'key+value');\n\t}\n}\nHeaders.prototype.entries = Headers.prototype[Symbol.iterator];\n\nObject.defineProperty(Headers.prototype, Symbol.toStringTag, {\n\tvalue: 'HeadersPrototype',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nfunction getHeaderPairs(headers, kind) {\n\tconst keys = Object.keys(headers[MAP]).sort();\n\treturn keys.map(kind === 'key' ? function (k) {\n\t\treturn [k];\n\t} : function (k) {\n\t\treturn [k, headers.get(k)];\n\t});\n}\n\nconst INTERNAL = Symbol('internal');\n\nfunction createHeadersIterator(target, kind) {\n\tconst iterator = Object.create(HeadersIteratorPrototype);\n\titerator[INTERNAL] = {\n\t\ttarget,\n\t\tkind,\n\t\tindex: 0\n\t};\n\treturn iterator;\n}\n\nconst HeadersIteratorPrototype = Object.setPrototypeOf({\n\tnext() {\n\t\t// istanbul ignore if\n\t\tif (!this || Object.getPrototypeOf(this) !== HeadersIteratorPrototype) {\n\t\t\tthrow new TypeError('Value of `this` is not a HeadersIterator');\n\t\t}\n\n\t\tvar _INTERNAL = this[INTERNAL];\n\t\tconst target = _INTERNAL.target,\n\t\t      kind = _INTERNAL.kind,\n\t\t      index = _INTERNAL.index;\n\n\t\tconst values = getHeaderPairs(target, kind);\n\t\tconst len = values.length;\n\t\tif (index >= len) {\n\t\t\treturn {\n\t\t\t\tvalue: undefined,\n\t\t\t\tdone: true\n\t\t\t};\n\t\t}\n\n\t\tconst pair = values[index];\n\t\tthis[INTERNAL].index = index + 1;\n\n\t\tlet result;\n\t\tif (kind === 'key') {\n\t\t\tresult = pair[0];\n\t\t} else if (kind === 'value') {\n\t\t\tresult = pair[1];\n\t\t} else {\n\t\t\tresult = pair;\n\t\t}\n\n\t\treturn {\n\t\t\tvalue: result,\n\t\t\tdone: false\n\t\t};\n\t}\n}, Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));\n\nObject.defineProperty(HeadersIteratorPrototype, Symbol.toStringTag, {\n\tvalue: 'HeadersIterator',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * response.js\n *\n * Response class provides content decoding\n */\n\nvar _require$2 = require('http');\n\nconst STATUS_CODES = _require$2.STATUS_CODES;\n\n/**\n * Response class\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\n\nclass Response {\n\tconstructor() {\n\t\tlet body = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t\tlet opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tBody.call(this, body, opts);\n\n\t\tthis.url = opts.url;\n\t\tthis.status = opts.status || 200;\n\t\tthis.statusText = opts.statusText || STATUS_CODES[this.status];\n\n\t\tthis.headers = new Headers(opts.headers);\n\n\t\tObject.defineProperty(this, Symbol.toStringTag, {\n\t\t\tvalue: 'Response',\n\t\t\twritable: false,\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true\n\t\t});\n\t}\n\n\t/**\n  * Convenience property representing if the request ended normally\n  */\n\tget ok() {\n\t\treturn this.status >= 200 && this.status < 300;\n\t}\n\n\t/**\n  * Clone this response\n  *\n  * @return  Response\n  */\n\tclone() {\n\n\t\treturn new Response(clone(this), {\n\t\t\turl: this.url,\n\t\t\tstatus: this.status,\n\t\t\tstatusText: this.statusText,\n\t\t\theaders: this.headers,\n\t\t\tok: this.ok\n\t\t});\n\t}\n}\n\nBody.mixIn(Response.prototype);\n\nObject.defineProperty(Response.prototype, Symbol.toStringTag, {\n\tvalue: 'ResponsePrototype',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * request.js\n *\n * Request class contains server only options\n */\n\nvar _require$3 = require('url');\n\nconst format_url = _require$3.format;\nconst parse_url = _require$3.parse;\n\n\nconst PARSED_URL = Symbol('url');\n\n/**\n * Request class\n *\n * @param   Mixed   input  Url or Request instance\n * @param   Object  init   Custom options\n * @return  Void\n */\nclass Request {\n\tconstructor(input) {\n\t\tlet init = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tlet parsedURL;\n\n\t\t// normalize input\n\t\tif (!(input instanceof Request)) {\n\t\t\tif (input && input.href) {\n\t\t\t\t// in order to support Node.js' Url objects; though WHATWG's URL objects\n\t\t\t\t// will fall into this branch also (since their `toString()` will return\n\t\t\t\t// `href` property anyway)\n\t\t\t\tparsedURL = parse_url(input.href);\n\t\t\t} else {\n\t\t\t\t// coerce input to a string before attempting to parse\n\t\t\t\tparsedURL = parse_url(`${input}`);\n\t\t\t}\n\t\t\tinput = {};\n\t\t} else {\n\t\t\tparsedURL = parse_url(input.url);\n\t\t}\n\n\t\tlet method = init.method || input.method || 'GET';\n\n\t\tif ((init.body != null || input instanceof Request && input.body !== null) && (method === 'GET' || method === 'HEAD')) {\n\t\t\tthrow new TypeError('Request with GET/HEAD method cannot have body');\n\t\t}\n\n\t\tlet inputBody = init.body != null ? init.body : input instanceof Request && input.body !== null ? clone(input) : null;\n\n\t\tBody.call(this, inputBody, {\n\t\t\ttimeout: init.timeout || input.timeout || 0,\n\t\t\tsize: init.size || input.size || 0\n\t\t});\n\n\t\t// fetch spec options\n\t\tthis.method = method.toUpperCase();\n\t\tthis.redirect = init.redirect || input.redirect || 'follow';\n\t\tthis.headers = new Headers(init.headers || input.headers || {});\n\n\t\tif (init.body != null) {\n\t\t\tconst contentType = extractContentType(this);\n\t\t\tif (contentType !== null && !this.headers.has('Content-Type')) {\n\t\t\t\tthis.headers.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\t// server only options\n\t\tthis.follow = init.follow !== undefined ? init.follow : input.follow !== undefined ? input.follow : 20;\n\t\tthis.compress = init.compress !== undefined ? init.compress : input.compress !== undefined ? input.compress : true;\n\t\tthis.counter = init.counter || input.counter || 0;\n\t\tthis.agent = init.agent || input.agent;\n\n\t\tthis[PARSED_URL] = parsedURL;\n\t\tObject.defineProperty(this, Symbol.toStringTag, {\n\t\t\tvalue: 'Request',\n\t\t\twritable: false,\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true\n\t\t});\n\t}\n\n\tget url() {\n\t\treturn format_url(this[PARSED_URL]);\n\t}\n\n\t/**\n  * Clone this request\n  *\n  * @return  Request\n  */\n\tclone() {\n\t\treturn new Request(this);\n\t}\n}\n\nBody.mixIn(Request.prototype);\n\nObject.defineProperty(Request.prototype, Symbol.toStringTag, {\n\tvalue: 'RequestPrototype',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nfunction getNodeRequestOptions(request) {\n\tconst parsedURL = request[PARSED_URL];\n\tconst headers = new Headers(request.headers);\n\n\t// fetch step 3\n\tif (!headers.has('Accept')) {\n\t\theaders.set('Accept', '*/*');\n\t}\n\n\t// Basic fetch\n\tif (!parsedURL.protocol || !parsedURL.hostname) {\n\t\tthrow new TypeError('Only absolute URLs are supported');\n\t}\n\n\tif (!/^https?:$/.test(parsedURL.protocol)) {\n\t\tthrow new TypeError('Only HTTP(S) protocols are supported');\n\t}\n\n\t// HTTP-network-or-cache fetch steps 5-9\n\tlet contentLengthValue = null;\n\tif (request.body == null && /^(POST|PUT)$/i.test(request.method)) {\n\t\tcontentLengthValue = '0';\n\t}\n\tif (request.body != null) {\n\t\tconst totalBytes = getTotalBytes(request);\n\t\tif (typeof totalBytes === 'number') {\n\t\t\tcontentLengthValue = String(totalBytes);\n\t\t}\n\t}\n\tif (contentLengthValue) {\n\t\theaders.set('Content-Length', contentLengthValue);\n\t}\n\n\t// HTTP-network-or-cache fetch step 12\n\tif (!headers.has('User-Agent')) {\n\t\theaders.set('User-Agent', 'node-fetch/1.0 (+https://github.com/bitinn/node-fetch)');\n\t}\n\n\t// HTTP-network-or-cache fetch step 16\n\tif (request.compress) {\n\t\theaders.set('Accept-Encoding', 'gzip,deflate');\n\t}\n\tif (!headers.has('Connection') && !request.agent) {\n\t\theaders.set('Connection', 'close');\n\t}\n\n\t// HTTP-network fetch step 4\n\t// chunked encoding is handled by Node.js\n\n\treturn Object.assign({}, parsedURL, {\n\t\tmethod: request.method,\n\t\theaders: headers.raw(),\n\t\tagent: request.agent\n\t});\n}\n\n/**\n * index.js\n *\n * a request API compatible with window.fetch\n */\n\nconst http = require('http');\nconst https = require('https');\n\nvar _require = require('stream');\n\nconst PassThrough = _require.PassThrough;\n\nvar _require2 = require('url');\n\nconst resolve_url = _require2.resolve;\n\nconst zlib = require('zlib');\n\n/**\n * Fetch function\n *\n * @param   Mixed    url   Absolute url or Request instance\n * @param   Object   opts  Fetch options\n * @return  Promise\n */\nfunction fetch(url, opts) {\n\n\t// allow custom promise\n\tif (!fetch.Promise) {\n\t\tthrow new Error('native promise missing, set fetch.Promise to your favorite alternative');\n\t}\n\n\tBody.Promise = fetch.Promise;\n\n\t// wrap http.request into fetch\n\treturn new fetch.Promise(function (resolve, reject) {\n\t\t// build request object\n\t\tconst request = new Request(url, opts);\n\t\tconst options = getNodeRequestOptions(request);\n\n\t\tconst send = (options.protocol === 'https:' ? https : http).request;\n\n\t\t// http.request only support string as host header, this hack make custom host header possible\n\t\tif (options.headers.host) {\n\t\t\toptions.headers.host = options.headers.host[0];\n\t\t}\n\n\t\t// send request\n\t\tconst req = send(options);\n\t\tlet reqTimeout;\n\n\t\tif (request.timeout) {\n\t\t\treq.once('socket', function (socket) {\n\t\t\t\treqTimeout = setTimeout(function () {\n\t\t\t\t\treq.abort();\n\t\t\t\t\treject(new FetchError(`network timeout at: ${request.url}`, 'request-timeout'));\n\t\t\t\t}, request.timeout);\n\t\t\t});\n\t\t}\n\n\t\treq.on('error', function (err) {\n\t\t\tclearTimeout(reqTimeout);\n\t\t\treject(new FetchError(`request to ${request.url} failed, reason: ${err.message}`, 'system', err));\n\t\t});\n\n\t\treq.on('response', function (res) {\n\t\t\tclearTimeout(reqTimeout);\n\n\t\t\t// handle redirect\n\t\t\tif (fetch.isRedirect(res.statusCode) && request.redirect !== 'manual') {\n\t\t\t\tif (request.redirect === 'error') {\n\t\t\t\t\treject(new FetchError(`redirect mode is set to error: ${request.url}`, 'no-redirect'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (request.counter >= request.follow) {\n\t\t\t\t\treject(new FetchError(`maximum redirect reached at: ${request.url}`, 'max-redirect'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!res.headers.location) {\n\t\t\t\t\treject(new FetchError(`redirect location header missing at: ${request.url}`, 'invalid-redirect'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// per fetch spec, for POST request with 301/302 response, or any request with 303 response, use GET when following redirect\n\t\t\t\tif (res.statusCode === 303 || (res.statusCode === 301 || res.statusCode === 302) && request.method === 'POST') {\n\t\t\t\t\trequest.method = 'GET';\n\t\t\t\t\trequest.body = null;\n\t\t\t\t\trequest.headers.delete('content-length');\n\t\t\t\t}\n\n\t\t\t\trequest.counter++;\n\n\t\t\t\tresolve(fetch(resolve_url(request.url, res.headers.location), request));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// normalize location header for manual redirect mode\n\t\t\tconst headers = new Headers();\n\t\t\tfor (const name of Object.keys(res.headers)) {\n\t\t\t\tif (Array.isArray(res.headers[name])) {\n\t\t\t\t\tfor (const val of res.headers[name]) {\n\t\t\t\t\t\theaders.append(name, val);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\theaders.append(name, res.headers[name]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (request.redirect === 'manual' && headers.has('location')) {\n\t\t\t\theaders.set('location', resolve_url(request.url, headers.get('location')));\n\t\t\t}\n\n\t\t\t// prepare response\n\t\t\tlet body = res.pipe(new PassThrough());\n\t\t\tconst response_options = {\n\t\t\t\turl: request.url,\n\t\t\t\tstatus: res.statusCode,\n\t\t\t\tstatusText: res.statusMessage,\n\t\t\t\theaders: headers,\n\t\t\t\tsize: request.size,\n\t\t\t\ttimeout: request.timeout\n\t\t\t};\n\n\t\t\t// HTTP-network fetch step 16.1.2\n\t\t\tconst codings = headers.get('Content-Encoding');\n\n\t\t\t// HTTP-network fetch step 16.1.3: handle content codings\n\n\t\t\t// in following scenarios we ignore compression support\n\t\t\t// 1. compression support is disabled\n\t\t\t// 2. HEAD request\n\t\t\t// 3. no Content-Encoding header\n\t\t\t// 4. no content response (204)\n\t\t\t// 5. content not modified response (304)\n\t\t\tif (!request.compress || request.method === 'HEAD' || codings === null || res.statusCode === 204 || res.statusCode === 304) {\n\t\t\t\tresolve(new Response(body, response_options));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For Node v6+\n\t\t\t// Be less strict when decoding compressed responses, since sometimes\n\t\t\t// servers send slightly invalid responses that are still accepted\n\t\t\t// by common browsers.\n\t\t\t// Always using Z_SYNC_FLUSH is what cURL does.\n\t\t\tconst zlibOptions = {\n\t\t\t\tflush: zlib.Z_SYNC_FLUSH,\n\t\t\t\tfinishFlush: zlib.Z_SYNC_FLUSH\n\t\t\t};\n\n\t\t\t// for gzip\n\t\t\tif (codings == 'gzip' || codings == 'x-gzip') {\n\t\t\t\tbody = body.pipe(zlib.createGunzip(zlibOptions));\n\t\t\t\tresolve(new Response(body, response_options));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for deflate\n\t\t\tif (codings == 'deflate' || codings == 'x-deflate') {\n\t\t\t\t// handle the infamous raw deflate response from old servers\n\t\t\t\t// a hack for old IIS and Apache servers\n\t\t\t\tconst raw = res.pipe(new PassThrough());\n\t\t\t\traw.once('data', function (chunk) {\n\t\t\t\t\t// see http://stackoverflow.com/questions/37519828\n\t\t\t\t\tif ((chunk[0] & 0x0F) === 0x08) {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflate());\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflateRaw());\n\t\t\t\t\t}\n\t\t\t\t\tresolve(new Response(body, response_options));\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// otherwise, use response as-is\n\t\t\tresolve(new Response(body, response_options));\n\t\t});\n\n\t\twriteToStream(req, request);\n\t});\n}\n\n/**\n * Redirect code matching\n *\n * @param   Number   code  Status code\n * @return  Boolean\n */\nfetch.isRedirect = function (code) {\n\treturn code === 301 || code === 302 || code === 303 || code === 307 || code === 308;\n};\n\n// expose Promise\nfetch.Promise = global.Promise;\n\nmodule.exports = exports = fetch;\nexports.Headers = Headers;\nexports.Request = Request;\nexports.Response = Response;\nexports.FetchError = FetchError;\n"]}