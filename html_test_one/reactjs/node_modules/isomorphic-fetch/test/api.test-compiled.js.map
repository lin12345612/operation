{"version":3,"sources":["api.test.js"],"names":[],"mappings":"AAAA;AACA;;AAEA,QAAQ,aAAR,EAAuB,QAAvB;AACA,QAAQ,mBAAR;AACA,IAAI,SAAS,QAAQ,MAAR,EAAgB,MAA7B;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,OAAO,oBAAX;AACA,IAAI,MAAM,gCAAV;;AAEA,SAAS,cAAT,CAAwB,QAAxB,EAAkC;AACjC,KAAI,SAAS,MAAT,IAAmB,GAAvB,EAA4B,MAAM,IAAI,KAAJ,CAAU,qBAAV,CAAN;AAC5B,QAAO,SAAS,IAAT,EAAP;AACA;;AAED,SAAS,OAAT,EAAkB,YAAW;;AAE5B,QAAO,YAAW;AACjB,OAAK,sBAAL,EACE,GADF,CACM,cADN,EAEE,KAFF,CAEQ,GAFR,EAEa,IAFb;AAGA,OAAK,sBAAL,EACE,GADF,CACM,WADN,EAEE,KAFF,CAEQ,GAFR,EAEa,GAFb;AAGA,EAPD;;AASA,IAAG,mBAAH,EAAwB,YAAW;AAClC,SAAO,KAAP,EAAc,EAAd,CAAiB,EAAjB,CAAoB,CAApB,CAAsB,UAAtB;AACA,EAFD;;AAIA,IAAG,0CAAH,EAA+C,UAAS,IAAT,EAAe;AAC7D,QAAM,4BAAN,EACE,IADF,CACO,cADP,EAEE,IAFF,CAEO,UAAS,IAAT,EAAe;AACpB,UAAO,IAAP,EAAa,EAAb,CAAgB,KAAhB,CAAsB,IAAtB;AACA;AACA,GALF,EAME,KANF,CAMQ,IANR;AAOA,EARD;;AAUA,IAAG,6CAAH,EAAkD,UAAS,IAAT,EAAe;AAChE,QAAM,yBAAN,EACE,IADF,CACO,cADP,EAEE,KAFF,CAEQ,UAAS,GAAT,EAAc;AACpB,UAAO,IAAI,QAAJ,EAAP,EAAuB,EAAvB,CAA0B,KAA1B,CAAgC,4BAAhC;AACA;AACA,GALF,EAME,KANF,CAMQ,IANR;AAOA,EARD;AAUA,CAnCD","file":"api.test-compiled.js","sourcesContent":["/*global fetch*/\n\"use strict\";\n\nrequire('es6-promise').polyfill();\nrequire('../fetch-npm-node');\nvar expect = require('chai').expect;\nvar nock = require('nock');\nvar good = 'hello world. 你好世界。';\nvar bad = 'good bye cruel world. 再见残酷的世界。';\n\nfunction responseToText(response) {\n\tif (response.status >= 400) throw new Error(\"Bad server response\");\n\treturn response.text();\n}\n\ndescribe('fetch', function() {\n\n\tbefore(function() {\n\t\tnock('https://mattandre.ws')\n\t\t\t.get('/succeed.txt')\n\t\t\t.reply(200, good);\n\t\tnock('https://mattandre.ws')\n\t\t\t.get('/fail.txt')\n\t\t\t.reply(404, bad);\n\t});\n\n\tit('should be defined', function() {\n\t\texpect(fetch).to.be.a('function');\n\t});\n\n\tit('should facilitate the making of requests', function(done) {\n\t\tfetch('//mattandre.ws/succeed.txt')\n\t\t\t.then(responseToText)\n\t\t\t.then(function(data) {\n\t\t\t\texpect(data).to.equal(good);\n\t\t\t\tdone();\n\t\t\t})\n\t\t\t.catch(done);\n\t});\n\n\tit('should do the right thing with bad requests', function(done) {\n\t\tfetch('//mattandre.ws/fail.txt')\n\t\t\t.then(responseToText)\n\t\t\t.catch(function(err) {\n\t\t\t\texpect(err.toString()).to.equal(\"Error: Bad server response\");\n\t\t\t\tdone();\n\t\t\t})\n\t\t\t.catch(done);\n\t});\n\n});\n"]}